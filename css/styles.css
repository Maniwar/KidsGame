* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
}

body {
    font-family: 'Comic Sans MS', 'Arial', sans-serif;
    background: linear-gradient(135deg, #FFB7C5 0%, #87CEEB 100%);
    touch-action: none; /* Prevent default touch behaviors */
}

#game-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

#game-canvas {
    display: block;
    width: 100%;
    height: 100%;
    touch-action: none; /* Prevent touch scrolling/zooming */
}

/* HUD Overlay */
#hud {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    padding: 20px;
    pointer-events: none;
    z-index: 10;
}

#score-display {
    display: flex;
    gap: 20px;
    justify-content: center;
    flex-wrap: wrap;
}

.hud-item {
    background: rgba(255, 255, 255, 0.9);
    padding: 10px 20px;
    border-radius: 20px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    font-size: 18px;
    font-weight: bold;
    color: #FF69B4;
}

.hud-item .label {
    color: #FFB7C5;
    margin-right: 5px;
}

/* Screen overlays */
.screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 183, 197, 0.95);
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 100;
    padding: 20px;
    overflow: hidden;
}

/* Game over screen - more transparent to see character */
#game-over-screen {
    background: rgba(255, 183, 197, 0.4);
    backdrop-filter: blur(3px);
}

.screen.active {
    display: flex;
}

.screen h1 {
    font-size: 48px;
    color: #FF69B4;
    text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.2);
    margin-bottom: 20px;
    text-align: center;
}

.screen h2 {
    font-size: 36px;
    color: #FF69B4;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
    margin-bottom: 20px;
}

.screen p {
    font-size: 20px;
    color: #FFF5F5;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    margin: 10px 0;
    text-align: center;
}

.score-summary {
    background: rgba(255, 255, 255, 0.9);
    padding: 30px;
    border-radius: 20px;
    margin: 20px 0;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

.score-summary p {
    font-size: 24px;
    color: #FF69B4;
    margin: 15px 0;
    text-shadow: none;
}

.score-summary span {
    color: #FFB347;
    font-weight: bold;
}

/* New High Score */
#new-high-score {
    margin: 20px 0;
    display: none;
}

#new-high-score h3 {
    color: #FFD700;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    font-size: 28px;
    margin: 10px 0;
}

#initials-input {
    font-family: 'Comic Sans MS', 'Arial', sans-serif;
    font-size: 24px;
    padding: 10px;
    text-align: center;
    text-transform: uppercase;
    width: 100px;
    margin: 10px;
    border: 3px solid #FF69B4;
    border-radius: 10px;
    background: white;
    color: #FF69B4;
    font-weight: bold;
}

/* Leaderboard */
.leaderboard {
    background: rgba(255, 255, 255, 0.9);
    padding: 20px;
    border-radius: 20px;
    margin: 20px auto;
    max-width: 400px;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

.leaderboard h3 {
    color: #FF69B4;
    font-size: 24px;
    margin-bottom: 15px;
}

#leaderboard-list {
    text-align: left;
}

.leaderboard-entry {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    margin: 5px 0;
    background: rgba(255, 183, 197, 0.2);
    border-radius: 10px;
    font-size: 18px;
    color: #FF69B4;
}

.leaderboard-entry.highlight {
    background: rgba(255, 215, 0, 0.3);
    border: 2px solid #FFD700;
    font-weight: bold;
}

.leaderboard-rank {
    font-weight: bold;
    margin-right: 10px;
    color: #FFB347;
}

.leaderboard-initials {
    flex: 1;
    font-weight: bold;
}

.leaderboard-score {
    color: #FFB347;
    font-weight: bold;
}

/* Dual Leaderboards Container */
.leaderboards-container {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
    margin: 10px auto;
    max-width: 700px;
}

.leaderboards-container .leaderboard {
    flex: 1;
    min-width: 250px;
    max-width: 320px;
    margin: 5px;
}

.local-leaderboard h3 {
    color: #87CEEB;
}

.local-leaderboard .leaderboard-entry {
    background: rgba(135, 206, 235, 0.2);
}

.local-leaderboard .leaderboard-rank,
.local-leaderboard .leaderboard-score {
    color: #5DADE2;
}

#local-leaderboard-list {
    text-align: left;
}

/* Settings Panel */
.settings-btn {
    background: linear-gradient(135deg, #87CEEB 0%, #B0E0E6 100%);
    font-size: 18px;
    padding: 10px 25px;
}

.tips-btn {
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
    font-size: 18px;
    padding: 10px 25px;
}

.tips-btn:hover {
    background: linear-gradient(135deg, #FFE44D 0%, #FFB732 100%);
}

/* Tips & Instructions Screen */
#tips-screen {
    background: rgba(255, 183, 197, 0.98);
    justify-content: flex-start;
    padding-top: 20px;
}

.tips-content {
    width: 100%;
    max-width: 600px;
    max-height: 65vh;
    overflow-y: auto;
    padding: 0 10px;
}

.tips-section {
    background: rgba(255, 255, 255, 0.9);
    padding: 15px 20px;
    border-radius: 15px;
    margin-bottom: 12px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.tips-section h3 {
    margin: 0 0 10px 0;
    color: #FF69B4;
    font-size: 18px;
}

.tips-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
}

.tip-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: #555;
}

.tip-key {
    background: linear-gradient(135deg, #FF69B4 0%, #FFB7C5 100%);
    color: white;
    padding: 4px 10px;
    border-radius: 8px;
    font-weight: bold;
    font-size: 12px;
    white-space: nowrap;
}

.tips-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.tips-list li {
    padding: 5px 0;
    font-size: 14px;
    color: #555;
    border-bottom: 1px solid rgba(255, 105, 180, 0.15);
}

.tips-list li:last-child {
    border-bottom: none;
}

.settings-options {
    background: rgba(255, 255, 255, 0.9);
    padding: 20px 30px;
    border-radius: 20px;
    margin: 20px 0;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

.setting-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 20px;
}

.setting-row label:first-child {
    color: #FF69B4;
    font-size: 18px;
    font-weight: bold;
}

.setting-hint {
    font-size: 14px !important;
    color: #999 !important;
    margin-top: 10px !important;
}

/* Toggle Switch */
.toggle-switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: 0.3s;
    border-radius: 34px;
}

.toggle-slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: 0.3s;
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

input:checked + .toggle-slider {
    background: linear-gradient(135deg, #FF69B4, #FFB7C5);
}

input:checked + .toggle-slider:before {
    transform: translateX(26px);
}

/* Buttons */
.game-button {
    font-family: 'Comic Sans MS', 'Arial', sans-serif;
    font-size: 24px;
    font-weight: bold;
    color: white;
    background: linear-gradient(135deg, #FF69B4 0%, #FFB7C5 100%);
    border: none;
    padding: 15px 40px;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    transition: transform 0.2s, box-shadow 0.2s;
    margin-top: 20px;
}

.game-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
}

.game-button:active {
    transform: translateY(0);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    .screen h1 {
        font-size: 32px;
    }

    .screen h2 {
        font-size: 28px;
    }

    .screen p {
        font-size: 16px;
    }

    .hud-item {
        font-size: 14px;
        padding: 8px 12px;
    }

    .game-button {
        font-size: 20px;
        padding: 12px 30px;
    }
}

@media (max-width: 480px) {
    .screen h1 {
        font-size: 24px;
    }

    #score-display {
        gap: 10px;
    }

    .hud-item {
        font-size: 12px;
        padding: 6px 10px;
    }
}

/* Mobile portrait - compact popup at bottom */
@media (max-width: 600px) and (orientation: portrait) {
    .screen {
        top: auto;
        bottom: 0;
        height: auto;
        max-height: 70%;
        border-radius: 30px 30px 0 0;
        padding: 20px 15px 30px;
        overflow-y: auto;
        justify-content: flex-start;
    }

    #start-screen {
        max-height: 55%;
    }

    #start-screen h1 {
        font-size: 22px;
        margin-bottom: 10px;
    }

    #start-screen p {
        font-size: 14px;
        margin: 5px 0;
    }

    /* Smaller settings button on mobile */
    .settings-btn {
        font-size: 14px !important;
        padding: 8px 20px !important;
        margin-top: 10px !important;
    }

    /* Settings panel mobile styles */
    #settings-panel {
        max-height: 60%;
    }

    .settings-options {
        padding: 15px 20px;
    }

    .setting-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }

    .setting-row label:first-child {
        font-size: 16px;
    }

    #game-over-screen h2 {
        font-size: 22px;
        margin-bottom: 10px;
    }

    .score-summary {
        padding: 15px;
        margin: 10px 0;
    }

    .score-summary p {
        font-size: 16px;
        margin: 8px 0;
    }

    #new-high-score h3 {
        font-size: 20px;
    }

    #initials-input {
        font-size: 20px;
        padding: 8px;
        width: 80px;
    }

    .leaderboard {
        padding: 15px;
        margin: 10px auto;
        max-width: 100%;
    }

    .leaderboard h3 {
        font-size: 18px;
        margin-bottom: 10px;
    }

    .leaderboard-entry {
        font-size: 14px;
        padding: 8px;
    }

    .leaderboards-container {
        flex-direction: column;
        align-items: center;
    }

    .leaderboards-container .leaderboard {
        min-width: unset;
        max-width: 100%;
        width: 100%;
    }

    .game-button {
        font-size: 18px;
        padding: 12px 25px;
        margin-top: 15px;
    }
}

/* Mobile landscape - side panel */
@media (max-height: 500px) and (orientation: landscape) {
    .screen {
        left: auto;
        right: 0;
        width: 50%;
        max-width: 320px;
        height: 100%;
        border-radius: 20px 0 0 20px;
        padding: 15px;
        overflow-y: auto;
        justify-content: flex-start;
    }

    #start-screen h1 {
        font-size: 20px;
        margin-bottom: 10px;
    }

    #start-screen p {
        font-size: 12px;
        margin: 4px 0;
    }

    #game-over-screen h2 {
        font-size: 20px;
        margin-bottom: 8px;
    }

    .score-summary {
        padding: 10px;
        margin: 8px 0;
    }

    .score-summary p {
        font-size: 14px;
        margin: 5px 0;
    }

    .leaderboard {
        padding: 10px;
        margin: 8px auto;
    }

    .leaderboard h3 {
        font-size: 16px;
    }

    .leaderboard-entry {
        font-size: 12px;
        padding: 6px;
    }

    .game-button {
        font-size: 16px;
        padding: 10px 20px;
        margin-top: 10px;
    }
}

/* Coin collection animation */
@keyframes coinCollectShake {
    0%, 100% {
        transform: scale(1) rotate(0deg);
    }
    10% {
        transform: scale(1.3) rotate(-5deg);
    }
    20% {
        transform: scale(1.3) rotate(5deg);
    }
    30% {
        transform: scale(1.3) rotate(-5deg);
    }
    40% {
        transform: scale(1.3) rotate(5deg);
    }
    50% {
        transform: scale(1.2) rotate(0deg);
    }
    60% {
        transform: scale(1.1) rotate(0deg);
    }
    80% {
        transform: scale(1.05) rotate(0deg);
    }
}

.coin-collect-shake {
    animation: coinCollectShake 0.5s ease-out;
}

/* Coin counter glow when receiving coins */
@keyframes coinGlow {
    0% {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 0 0px rgba(255, 215, 0, 0);
    }
    50% {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 0 30px rgba(255, 215, 0, 0.8), 0 0 60px rgba(255, 215, 0, 0.4);
    }
    100% {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 0 0px rgba(255, 215, 0, 0);
    }
}

.coin-collect-glow {
    animation: coinGlow 0.6s ease-out;
}

/* Sparkle particles around coin counter */
.coin-particle {
    position: absolute;
    width: 8px;
    height: 8px;
    background: radial-gradient(circle, #FFD700, #FFA500);
    border-radius: 50%;
    pointer-events: none;
    z-index: 1000;
    animation: sparkleFloat 0.8s ease-out forwards;
}

@keyframes sparkleFloat {
    0% {
        opacity: 1;
        transform: translate(0, 0) scale(1);
    }
    50% {
        opacity: 1;
    }
    100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(0);
    }
}

/* Screen flash effect when particles arrive at coin counter */
@keyframes flashFade {
    0% {
        opacity: 1;
    }
    100% {
        opacity: 0;
    }
}

/* ============================================
   SHOP UI STYLES
   ============================================ */

/* Total coins display on start screen */
#total-coins-display {
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
    padding: 10px 25px;
    border-radius: 25px;
    margin-bottom: 15px;
    box-shadow: 0 4px 12px rgba(255, 165, 0, 0.4);
    display: inline-flex;
    align-items: center;
    gap: 10px;
}

#total-coins-display .coin-icon {
    font-size: 24px;
}

#total-coins-display #total-coins {
    font-size: 22px;
    font-weight: bold;
    color: white;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
}

/* Menu buttons container */
.menu-buttons {
    display: flex;
    gap: 15px;
    margin-top: 10px;
}

.shop-btn {
    background: linear-gradient(135deg, #9B59B6 0%, #8E44AD 100%);
    font-size: 18px;
    padding: 10px 25px;
}

.shop-btn:hover {
    background: linear-gradient(135deg, #A569BD 0%, #9B59B6 100%);
}

/* Shop Screen */
#shop-screen {
    background: rgba(255, 183, 197, 0.98);
    justify-content: flex-start;
    padding-top: 20px;
}

.shop-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    max-width: 600px;
    margin-bottom: 15px;
    padding: 0 10px;
}

.shop-header h2 {
    margin: 0;
}

.shop-coins {
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
    padding: 10px 20px;
    border-radius: 25px;
    display: flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 4px 12px rgba(255, 165, 0, 0.4);
}

.shop-coins .coin-icon {
    font-size: 20px;
}

.shop-coins #shop-total-coins {
    font-size: 20px;
    font-weight: bold;
    color: white;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
}

/* Shop content area */
.shop-content {
    flex: 1;
    width: 100%;
    max-width: 650px;
    overflow-y: auto;
    padding: 10px;
}

.shop-section {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 20px;
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.shop-section h3 {
    color: #FF69B4;
    font-size: 20px;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 2px solid rgba(255, 105, 180, 0.2);
}

/* Shop items grid */
.shop-items {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
    gap: 10px;
}

/* Individual shop item */
.shop-item {
    background: white;
    border-radius: 15px;
    padding: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 3px solid transparent;
    position: relative;
}

.shop-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
}

.shop-item.equipped {
    border-color: #FFD700;
    background: linear-gradient(135deg, #FFFDF0 0%, #FFF9E0 100%);
}

.shop-item.owned {
    border-color: #90EE90;
}

.shop-item.locked {
    opacity: 0.7;
}

.shop-item.locked:hover {
    opacity: 1;
}

/* Color swatch preview */
.item-color-swatch {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-bottom: 8px;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2), 0 2px 4px rgba(0, 0, 0, 0.1);
    border: 2px solid rgba(0, 0, 0, 0.1);
}

/* Special "no clothes" swatch */
.item-color-swatch.no-clothes {
    background: repeating-linear-gradient(
        45deg,
        #fff,
        #fff 5px,
        #f0f0f0 5px,
        #f0f0f0 10px
    );
    position: relative;
}

.item-color-swatch.no-clothes::after {
    content: "✕";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 24px;
    color: #ccc;
}

/* Rainbow swatch animation */
.item-color-swatch.rainbow {
    background: linear-gradient(
        135deg,
        #ff0000,
        #ff7f00,
        #ffff00,
        #00ff00,
        #0000ff,
        #4b0082,
        #9400d3
    );
    background-size: 400% 400%;
    animation: rainbowShift 3s ease infinite;
}

@keyframes rainbowShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Sparkle swatch animation */
.item-color-swatch.sparkle {
    position: relative;
    overflow: hidden;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2), 0 2px 8px rgba(255, 255, 255, 0.4);
}

.item-color-swatch.sparkle::before {
    content: "";
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: conic-gradient(
        from 0deg,
        transparent 0deg,
        rgba(255, 255, 255, 0.8) 10deg,
        transparent 20deg,
        transparent 90deg,
        rgba(255, 255, 255, 0.6) 100deg,
        transparent 110deg,
        transparent 180deg,
        rgba(255, 255, 255, 0.7) 190deg,
        transparent 200deg,
        transparent 270deg,
        rgba(255, 255, 255, 0.5) 280deg,
        transparent 290deg
    );
    animation: sparkleRotate 3s linear infinite;
}

.item-color-swatch.sparkle::after {
    content: "✦";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 18px;
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 0 6px rgba(255, 255, 255, 0.8);
    animation: sparklePulse 1.5s ease-in-out infinite;
}

@keyframes sparkleRotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

@keyframes sparklePulse {
    0%, 100% { opacity: 0.6; transform: translate(-50%, -50%) scale(0.8); }
    50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
}

.item-name {
    font-size: 12px;
    font-weight: bold;
    color: #666;
    text-align: center;
    margin-bottom: 5px;
}

.item-price {
    font-size: 14px;
    font-weight: bold;
    color: #FFB347;
    display: flex;
    align-items: center;
    gap: 3px;
}

.item-price.free {
    color: #90EE90;
}

.item-price .coin-icon {
    font-size: 12px;
}

/* Status badges */
.item-status {
    position: absolute;
    top: -8px;
    right: -8px;
    padding: 3px 8px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: bold;
    color: white;
}

.item-status.equipped-badge {
    background: linear-gradient(135deg, #FFD700, #FFA500);
}

.item-status.owned-badge {
    background: linear-gradient(135deg, #90EE90, #32CD32);
}

/* Cannot afford styling */
.shop-item.cannot-afford .item-price {
    color: #FF6B6B;
}

/* Action button within item */
.item-action-btn {
    margin-top: 8px;
    padding: 5px 12px;
    border: none;
    border-radius: 15px;
    font-size: 11px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s ease;
}

.item-action-btn.buy-btn {
    background: linear-gradient(135deg, #FFD700, #FFA500);
    color: white;
}

.item-action-btn.buy-btn:hover {
    transform: scale(1.05);
}

.item-action-btn.buy-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
}

.item-action-btn.equip-btn {
    background: linear-gradient(135deg, #90EE90, #32CD32);
    color: white;
}

.item-action-btn.equip-btn:hover {
    transform: scale(1.05);
}

.item-action-btn.equipped-btn {
    background: #eee;
    color: #999;
    cursor: default;
}

/* Mystery Power-Up Box */
.mystery-box-section h3 {
    color: #9B59B6 !important;
    border-bottom-color: rgba(155, 89, 182, 0.3) !important;
}

.mystery-box-container {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 5px 0;
}

.mystery-box-item {
    display: flex;
    align-items: center;
    gap: 15px;
    width: 100%;
    background: linear-gradient(135deg, #F3E5F5, #E1BEE7);
    border-radius: 15px;
    padding: 12px 15px;
    border: 3px solid #CE93D8;
    transition: all 0.2s ease;
}

.mystery-box-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(155, 89, 182, 0.3);
}

.mystery-box-item.sold-out {
    opacity: 0.5;
    border-color: #ccc;
    background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
}

.mystery-box-icon {
    font-size: 40px;
    animation: mysteryBoxBounce 2s ease-in-out infinite;
    flex-shrink: 0;
}

.mystery-box-item.sold-out .mystery-box-icon {
    animation: none;
}

@keyframes mysteryBoxBounce {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    25% { transform: translateY(-4px) rotate(-5deg); }
    75% { transform: translateY(-4px) rotate(5deg); }
}

.mystery-box-info {
    flex: 1;
    min-width: 0;
}

.mystery-box-title {
    font-size: 14px;
    font-weight: bold;
    color: #6A1B9A;
    margin-bottom: 3px;
}

.mystery-box-desc {
    font-size: 11px;
    color: #8E24AA;
    margin-bottom: 4px;
}

.mystery-box-stock {
    font-size: 11px;
    color: #AB47BC;
    font-weight: bold;
}

.mystery-box-buy-btn {
    padding: 10px 18px;
    border: none;
    border-radius: 15px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s ease;
    background: linear-gradient(135deg, #AB47BC, #8E24AA);
    color: white;
    white-space: nowrap;
    display: flex;
    align-items: center;
    gap: 4px;
    flex-shrink: 0;
}

.mystery-box-buy-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(142, 36, 170, 0.4);
}

.mystery-box-buy-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.mystery-box-buy-btn .coin-icon {
    font-size: 14px;
}

/* Mystery box reveal animation */
@keyframes mysteryReveal {
    0% { transform: scale(1) rotate(0deg); }
    25% { transform: scale(1.3) rotate(-10deg); }
    50% { transform: scale(1.3) rotate(10deg); }
    75% { transform: scale(1.1) rotate(-5deg); }
    100% { transform: scale(1) rotate(0deg); }
}

.mystery-box-reveal {
    animation: mysteryReveal 0.5s ease;
}

/* Shop back button */
#shop-back-button {
    margin-top: 15px;
    margin-bottom: 20px;
}

/* Purchase success animation */
@keyframes purchaseSuccess {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.purchase-success {
    animation: purchaseSuccess 0.3s ease;
}

/* Mobile responsive shop styles */
@media (max-width: 600px) {
    #shop-screen {
        padding: 15px 10px;
    }

    .shop-header {
        flex-direction: column;
        gap: 10px;
    }

    .shop-header h2 {
        font-size: 24px;
    }

    .shop-section h3 {
        font-size: 18px;
    }

    .shop-items {
        grid-template-columns: repeat(auto-fill, minmax(75px, 1fr));
        gap: 8px;
    }

    .shop-item {
        padding: 8px;
    }

    .item-color-swatch {
        width: 40px;
        height: 40px;
    }

    .item-name {
        font-size: 10px;
    }

    .item-price {
        font-size: 12px;
    }

    .item-action-btn {
        font-size: 10px;
        padding: 4px 10px;
    }
}

/* Mobile portrait shop - full screen with scroll */
@media (max-width: 600px) and (orientation: portrait) {
    #shop-screen {
        max-height: 85%;
        justify-content: flex-start;
    }

    .shop-content {
        max-height: calc(100% - 150px);
    }
}

/* Landscape mobile shop */
@media (max-height: 500px) and (orientation: landscape) {
    #shop-screen {
        width: 60%;
        max-width: 400px;
    }

    .shop-header h2 {
        font-size: 20px;
    }

    .shop-section {
        padding: 10px;
        margin-bottom: 10px;
    }

    .shop-items {
        grid-template-columns: repeat(auto-fill, minmax(65px, 1fr));
    }

    .item-color-swatch {
        width: 35px;
        height: 35px;
    }
}

/* ============================================
   GAME OVER SCREEN ENHANCEMENTS
   ============================================ */

/* Total coins badge (shared style for game over) */
.total-coins-badge {
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
    padding: 8px 20px;
    border-radius: 20px;
    margin-bottom: 10px;
    box-shadow: 0 4px 12px rgba(255, 165, 0, 0.4);
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.total-coins-badge .coin-icon {
    font-size: 20px;
}

.total-coins-badge span:last-child {
    font-size: 18px;
    font-weight: bold;
    color: white;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
}

/* Game over buttons container */
.gameover-buttons {
    display: flex;
    gap: 15px;
    margin: 15px 0;
    justify-content: center;
    flex-wrap: wrap;
}

.gameover-buttons .game-button {
    min-width: 120px;
}

/* Mobile adjustments for game over buttons */
@media (max-width: 400px) {
    .gameover-buttons {
        flex-direction: column;
        gap: 10px;
    }

    .gameover-buttons .game-button {
        width: 100%;
    }
}

/* ============================================
   RECOVERY CODE SECTION
   ============================================ */

.recovery-section {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.2);
}

.recovery-section h3 {
    color: #FFD700;
    margin-bottom: 5px;
}

.recovery-section h4 {
    color: #FF69B4;
    margin: 15px 0 5px 0;
    font-size: 14px;
}

.recovery-code-display {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin: 10px 0;
}

#recovery-code {
    font-family: 'Courier New', monospace;
    font-size: 18px;
    font-weight: bold;
    color: #00FF00;
    background: rgba(0, 0, 0, 0.5);
    padding: 8px 15px;
    border-radius: 8px;
    letter-spacing: 2px;
    user-select: all;
}

.small-btn {
    padding: 8px 12px;
    border: none;
    border-radius: 6px;
    background: linear-gradient(135deg, #FF69B4 0%, #FF1493 100%);
    color: white;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.2s;
}

.small-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 2px 10px rgba(255, 105, 180, 0.5);
}

.small-btn:active {
    transform: scale(0.95);
}

.restore-input-row {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin: 10px 0;
}

#restore-code-input {
    font-family: 'Courier New', monospace;
    font-size: 14px;
    padding: 8px 12px;
    border: 2px solid #FF69B4;
    border-radius: 6px;
    background: rgba(0, 0, 0, 0.5);
    color: white;
    text-transform: uppercase;
    width: 150px;
    text-align: center;
}

#restore-code-input::placeholder {
    color: rgba(255, 255, 255, 0.4);
    text-transform: none;
}

#restore-code-input:focus {
    outline: none;
    border-color: #FFD700;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
}

.restore-status {
    font-size: 12px;
    min-height: 18px;
    margin: 5px 0;
}

.restore-status.success {
    color: #00FF00;
}

.restore-status.error {
    color: #FF4444;
}

.restore-status.loading {
    color: #FFD700;
}

/* Milestone Finish Line Popup */
.milestone-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.5);
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FFD700 100%);
    border: 4px solid #FFFFFF;
    border-radius: 20px;
    padding: 25px 40px;
    text-align: center;
    z-index: 1000;
    box-shadow:
        0 0 30px rgba(255, 215, 0, 0.8),
        0 0 60px rgba(255, 165, 0, 0.5),
        inset 0 0 20px rgba(255, 255, 255, 0.3);
    opacity: 0;
    transition: all 0.3s ease-out;
    pointer-events: none;
}

.milestone-popup.show {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
}

.milestone-banner {
    font-size: 32px;
    font-weight: bold;
    color: #FFFFFF;
    text-shadow:
        2px 2px 0 #FF6B6B,
        -2px -2px 0 #FF6B6B,
        2px -2px 0 #FF6B6B,
        -2px 2px 0 #FF6B6B,
        0 0 10px rgba(255, 107, 107, 0.8);
    margin-bottom: 10px;
    animation: milestoneGlow 0.5s ease-in-out infinite alternate;
}

@keyframes milestoneGlow {
    from { text-shadow: 2px 2px 0 #FF6B6B, -2px -2px 0 #FF6B6B, 2px -2px 0 #FF6B6B, -2px 2px 0 #FF6B6B, 0 0 10px rgba(255, 107, 107, 0.8); }
    to { text-shadow: 2px 2px 0 #FF6B6B, -2px -2px 0 #FF6B6B, 2px -2px 0 #FF6B6B, -2px 2px 0 #FF6B6B, 0 0 25px rgba(255, 107, 107, 1); }
}

.milestone-bonus {
    font-size: 24px;
    font-weight: bold;
    color: #228B22;
    text-shadow: 1px 1px 0 #FFFFFF;
    margin-bottom: 8px;
}

.milestone-record {
    font-size: 16px;
    color: #8B4513;
    font-weight: bold;
}

/* Milestone best display in game over */
.milestone-best {
    color: #FFD700;
    font-size: 0.85em;
}

/* Milestone Screen - compact bar at bottom */
.milestone-screen {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
    width: auto;
    max-width: 95vw;
}

.milestone-screen.show {
    opacity: 1;
}

.milestone-content {
    background: rgba(255, 105, 180, 0.8);
    border: 2px solid #FFFFFF;
    border-radius: 15px;
    padding: 10px 15px;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    pointer-events: auto;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 8px 12px;
    max-width: 95vw;
}

.milestone-content .milestone-banner {
    font-size: 16px;
    font-weight: bold;
    color: #FFFFFF;
    white-space: nowrap;
}

.milestone-content .milestone-bonus {
    font-size: 14px;
    color: #90EE90;
    font-weight: bold;
    white-space: nowrap;
}

.milestone-buttons {
    display: flex;
    gap: 8px;
    flex-shrink: 0;
}

.milestone-shop-btn {
    background: linear-gradient(135deg, #9B59B6 0%, #8E44AD 100%);
    color: white;
    border: none;
    padding: 8px 15px;
    font-size: 14px;
    font-weight: bold;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.milestone-shop-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 3px 10px rgba(155, 89, 182, 0.5);
}

.milestone-continue-btn {
    background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
    color: white;
    border: none;
    padding: 8px 15px;
    font-size: 14px;
    font-weight: bold;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.milestone-continue-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 3px 10px rgba(76, 175, 80, 0.5);
}

/* Milestone mystery box quick-buy button */
.milestone-mystery-btn {
    background: linear-gradient(135deg, #AB47BC 0%, #8E24AA 100%);
    color: white;
    border: none;
    padding: 6px 12px;
    font-size: 12px;
    font-weight: bold;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
    display: inline-flex;
    align-items: center;
    gap: 3px;
    animation: mysteryBoxPulse 1.5s ease-in-out infinite;
    width: 100%;
    justify-content: center;
}

.milestone-mystery-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 3px 12px rgba(142, 36, 170, 0.6);
}

.milestone-mystery-btn.disabled {
    background: #999;
    cursor: not-allowed;
    animation: none;
}

.milestone-mystery-btn .mystery-remaining {
    font-size: 10px;
    opacity: 0.8;
}

@keyframes mysteryBoxPulse {
    0%, 100% { box-shadow: 0 0 5px rgba(171, 71, 188, 0.4); }
    50% { box-shadow: 0 0 15px rgba(171, 71, 188, 0.8); }
}

/* Resume Countdown */
.resume-countdown {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 120px;
    font-weight: bold;
    color: #FFFFFF;
    text-shadow:
        0 0 20px #FF69B4,
        0 0 40px #FF69B4,
        0 0 60px #FF69B4;
    z-index: 1001;
    opacity: 0;
}

.resume-countdown.pulse {
    animation: countdownPulse 0.6s ease-out forwards;
}

.resume-countdown.go {
    color: #4CAF50;
    text-shadow:
        0 0 20px #4CAF50,
        0 0 40px #4CAF50,
        0 0 60px #4CAF50;
    animation: countdownPulse 0.4s ease-out forwards;
}

@keyframes countdownPulse {
    0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(2);
    }
    50% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
    }
    100% {
        opacity: 0.8;
        transform: translate(-50%, -50%) scale(0.9);
    }
}
